// @ts-ignore
let foodNutritionData = {
	"url": "",
	"status": "success",
	"title": "Bacon, meatless",
	"basicMacros": {
	"calories": {},
	"carbohydrates": {},
	"fats": {},
	"protein": {},
	"minerals": {},
	"other": {}
},
	"fullNutritionalData": [
	{
		"title": "Calorie Information",
		"raw_nutritional_data": [
			{
				"name": "energy",
				"value": "309",
				"daily_value": "",
				"units": "kcal"
			}
		]
	},
	{
		"title": "Carbohydrates",
		"raw_nutritional_data": {
			"0": {
				"name": "carbohydrates",
				"value": "5.31",
				"units": "g"
			},
			"1": {
				"name": "fiber",
				"value": "2.6",
				"units": "g"
			},
			"2": {
				"name": "sugars",
				"value": "0",
				"units": "g"
			},
			"3": {
				"name": "net_carbs",
				"value": "2.71",
				"units": "g"
			}
		}
	},
	{
		"title": "Fats & Fatty Acids",
		"raw_nutritional_data": {
			"0": {
				"name": "fat",
				"value": "29.52",
				"units": "g"
			},
			"1": {
				"name": "saturates",
				"value": "4.622",
				"units": "g"
			},
			"2": {
				"name": "butanoic_acid",
				"value": "0",
				"units": "g"
			},
			"3": {
				"name": "decanoic_acid",
				"value": "0",
				"units": "g"
			},
			"4": {
				"name": "dodecanoic_acid",
				"value": "0.245",
				"units": "g"
			},
			"5": {
				"name": "hexadecanoic_acid",
				"value": "3.045",
				"units": "g"
			},
			"6": {
				"name": "hexanoic_acid",
				"value": "0",
				"units": "g"
			},
			"7": {
				"name": "octadecanoic_acid",
				"value": "1.169",
				"units": "g"
			},
			"8": {
				"name": "octanoic_acid",
				"value": "0",
				"units": "g"
			},
			"9": {
				"name": "tetradecanoic_acid",
				"value": "0.163",
				"units": "g"
			},
			"10": {
				"name": "monounsaturated",
				"value": "7.095",
				"units": "g"
			},
			"11": {
				"name": "docosenoic_acid",
				"value": "0",
				"units": "g"
			},
			"12": {
				"name": "eicosenoic_acid",
				"value": "0",
				"units": "g"
			},
			"13": {
				"name": "hexadecenoic_acid",
				"value": "0",
				"units": "g"
			},
			"14": {
				"name": "octadecenoic_acid",
				"value": "7.095",
				"units": "g"
			},
			"15": {
				"name": "polyunsaturated",
				"value": "15.441",
				"units": "g"
			},
			"16": {
				"name": "DHA",
				"value": "0",
				"units": "g"
			},
			"17": {
				"name": "DPA",
				"value": "0",
				"units": "g"
			},
			"18": {
				"name": "EPA",
				"value": "0",
				"units": "g"
			},
			"19": {
				"name": "eicosatetraenoic_acid",
				"value": "0",
				"units": "g"
			},
			"20": {
				"name": "octadecadienoic_acid",
				"value": "13.756",
				"units": "g"
			},
			"21": {
				"name": "octadecatetraenoic_acid",
				"value": "0",
				"units": "g"
			},
			"22": {
				"name": "octadecatrienoic_acid",
				"value": "1.686",
				"units": "g"
			}
		}
	},
	{
		"title": "Protein & Amino Acids",
		"raw_nutritional_data": {
			"0": {
				"name": "protein",
				"value": "11.69",
				"units": "g"
			},
			"1": {
				"name": "alanine",
				"value": "0.492",
				"units": "g"
			},
			"2": {
				"name": "arginine",
				"value": "0.875",
				"units": "g"
			},
			"3": {
				"name": "aspartic_acid",
				"value": "1.33",
				"units": "g"
			},
			"4": {
				"name": "cystine",
				"value": "0.176",
				"units": "g"
			},
			"5": {
				"name": "glutamic_acid",
				"value": "2.429",
				"units": "g"
			},
			"6": {
				"name": "glycine",
				"value": "0.473",
				"units": "g"
			},
			"7": {
				"name": "histidine",
				"value": "0.299",
				"units": "g"
			},
			"8": {
				"name": "isoleucine",
				"value": "0.559",
				"units": "g"
			},
			"9": {
				"name": "leucine",
				"value": "0.914",
				"units": "g"
			},
			"10": {
				"name": "lysine",
				"value": "0.727",
				"units": "g"
			},
			"11": {
				"name": "methionine",
				"value": "0.146",
				"units": "g"
			},
			"12": {
				"name": "phenylalanine",
				"value": "0.611",
				"units": "g"
			},
			"13": {
				"name": "proline",
				"value": "0.643",
				"units": "g"
			},
			"14": {
				"name": "serine",
				"value": "0.626",
				"units": "g"
			},
			"15": {
				"name": "threonine",
				"value": "0.453",
				"units": "g"
			},
			"16": {
				"name": "tryptophan",
				"value": "0.161",
				"units": "g"
			},
			"17": {
				"name": "tyrosine",
				"value": "0.4",
				"units": "g"
			},
			"18": {
				"name": "valine",
				"value": "0.593",
				"units": "g"
			},
			"19": {
				"name": "phenylalanine",
				"value": "1.011",
				"units": "g"
			},
			"20": {
				"name": "methionine",
				"value": "0.146",
				"units": "g"
			}
		}
	},
	{
		"title": "Vitamins",
		"raw_nutritional_data": {
			"0": {
				"name": "vitamin_a",
				"value": "0",
				"units": "g"
			},
			"1": {
				"name": "carotene_alpha",
				"value": "0",
				"units": "g"
			},
			"2": {
				"name": "carotene_beta",
				"value": "0",
				"units": "g"
			},
			"3": {
				"name": "cryptoxanthin_beta",
				"value": "0",
				"units": "g"
			},
			"4": {
				"name": "lutein",
				"value": "0",
				"units": "g"
			},
			"5": {
				"name": "lycopene",
				"value": "0",
				"units": "g"
			},
			"6": {
				"name": "retinol",
				"value": "0",
				"units": "g"
			},
			"7": {
				"name": "vitamin_b1",
				"value": "0",
				"units": "g"
			},
			"8": {
				"name": "vitamin_b2",
				"value": "0",
				"units": "g"
			},
			"9": {
				"name": "vitamin_b3",
				"value": "0",
				"units": "g"
			},
			"10": {
				"name": "vitamin_b5",
				"value": "0.000113",
				"units": "g"
			},
			"11": {
				"name": "vitamin_b12",
				"value": "0",
				"units": "g"
			},
			"12": {
				"name": "folate",
				"value": "0",
				"units": "g"
			},
			"13": {
				"name": "vitamin_e",
				"value": "0.0069",
				"units": "g"
			},
			"14": {
				"name": "choline",
				"value": "0.045",
				"units": "g"
			}
		}
	},
	{
		"title": "Minerals",
		"raw_nutritional_data": {
			"0": {
				"name": "calcium",
				"value": "0.023",
				"units": "g"
			},
			"1": {
				"name": "copper",
				"value": "0",
				"units": "g"
			},
			"2": {
				"name": "iron",
				"value": "0.00241",
				"units": "g"
			},
			"3": {
				"name": "magnesium",
				"value": "0.019",
				"units": "g"
			},
			"4": {
				"name": "manganese",
				"value": "0.0002",
				"units": "g"
			},
			"5": {
				"name": "phosphorus",
				"value": "0.07",
				"units": "g"
			},
			"6": {
				"name": "potassium",
				"value": "0.17",
				"units": "g"
			},
			"7": {
				"name": "selenium",
				"value": "0",
				"units": "g"
			},
			"8": {
				"name": "sodium",
				"value": "1.465",
				"units": "g"
			},
			"9": {
				"name": "zinc",
				"value": "0",
				"units": "g"
			}
		}
	},
	null,
	{
		"title": "Other",
		"raw_nutritional_data": {
			"0": {
				"name": "alcohol_ethyl",
				"value": "0",
				"units": "g"
			},
			"1": {
				"name": "ash",
				"value": "4.5",
				"units": "g"
			},
			"2": {
				"name": "caffeine",
				"value": "0",
				"units": "g"
			},
			"3": {
				"name": "theobromine",
				"value": "0",
				"units": "g"
			},
			"4": {
				"name": "water",
				"value": "48.98",
				"units": "g"
			}
		}
	}
]
}

let fmc = {
	"1": {
		"name": "energy",
		"amount": 555
	},
	"2": {
		"name": "protein",
		"amount": 0
	},
	"3": {
		"1": {
			"name": "fiber",
			"amount": 0
		},
		"2": {
			"1": {
				"name": "glucose",
				"amount": 0
			},
			"2": {
				"name": "fructose",
				"amount": 0
			},
			"3": {
				"name": "sucrose",
				"amount": 0
			},
			"4": {
				"name": "lactose",
				"amount": 0
			},
			"5": {
				"name": "maltose",
				"amount": 0
			},
			"6": {
				"name": "galactose",
				"amount": 0
			},
			"name": "sugar",
			"amount": 0
		},
		"3": {
			"name": "starch",
			"amount": 0
		},
		"name": "carbohydrates",
		"amount": 0
	},
	"4": {
		"1": {
			"name": "saturates",
			"amount": 0
		},
		"2": {
			"name": "butanoic_acid",
			"amount": 0
		},
		"3": {
			"name": "decanoic_acid",
			"amount": 0
		},
		"4": {
			"name": "dodecanoic_acid",
			"amount": 0
		},
		"5": {
			"name": "hexadecanoic_acid",
			"amount": 0
		},
		"6": {
			"name": "hexanoic_acid",
			"amount": 0
		},
		"7": {
			"name": "octadecanoic_acid",
			"amount": 0
		},
		"8": {
			"name": "octanoic_acid",
			"amount": 0
		},
		"9": {
			"name": "tetradecanoic_acid",
			"amount": 0
		},
		"10": {
			"name": "monounsaturated",
			"amount": 0
		},
		"11": {
			"name": "docosenoic_acid",
			"amount": 0
		},
		"12": {
			"name": "eicosenoic_acid",
			"amount": 0
		},
		"13": null,
		"14": {
			"name": "octadecenoic_acid",
			"amount": 0
		},
		"15": {
			"name": "polyunsaturated",
			"amount": 0
		},
		"16": {
			"name": "DHA",
			"amount": 0
		},
		"17": {
			"name": "DPA",
			"amount": 0
		},
		"18": {
			"name": "EPA",
			"amount": 0
		},
		"19": {
			"name": "eicosatetraenoic_acid",
			"amount": 0
		},
		"20": {
			"name": "octadecadienoic_acid",
			"amount": 0
		},
		"21": {
			"name": "octadecatetraenoic_acid",
			"amount": 0
		},
		"22": {
			"name": "octadecatrienoic_acid",
			"amount": 0
		},
		"name": "hexadecenoic_acid",
		"amount": 0
	},
	"5": {
		"name": "water",
		"amount": 0
	},
	"6": {
		"1": {
			"name": "vitamin_a",
			"amount": 0
		},
		"2": {
			"name": "vitamin_b1",
			"amount": 0
		},
		"3": {
			"name": "vitamin_b2",
			"amount": 0
		},
		"4": {
			"name": "vitamin_b3",
			"amount": 0
		},
		"5": {
			"name": "vitamin_b5",
			"amount": 0
		},
		"6": {
			"name": "vitamin_b6",
			"amount": 0
		},
		"7": {
			"name": "vitamin_b7",
			"amount": 0
		},
		"8": {
			"name": "vitamin_b9",
			"amount": 0
		},
		"9": {
			"name": "vitamin_b12",
			"amount": 0
		},
		"10": {
			"name": "vitamin_c",
			"amount": 0
		},
		"11": {
			"name": "vitamin_d2",
			"amount": 0
		},
		"12": {
			"name": "vitamin_d3",
			"amount": 0
		},
		"13": {
			"name": "vitamin_e",
			"amount": 0
		},
		"14": {
			"name": "vitamin_k1",
			"amount": 0
		},
		"15": {
			"name": "vitamin_k2",
			"amount": 0
		},
		"name": "vitamins",
		"amount": null
	},
	"7": {
		"name": "minerals",
		"amount": {
			"1": {
				"name": "betaine",
				"amount": 0
			},
			"2": {
				"name": "boron",
				"amount": 0
			},
			"3": {
				"name": "bromine",
				"amount": 0
			},
			"4": {
				"name": "caffeine",
				"amount": 0
			},
			"5": {
				"name": "calcium",
				"amount": 0
			},
			"6": {
				"name": "copper",
				"amount": 0
			},
			"7": {
				"name": "choline",
				"amount": 0
			},
			"8": {
				"name": "iron",
				"amount": 0
			},
			"9": {
				"name": "flouride",
				"amount": 0
			},
			"10": {
				"name": "lycopene",
				"amount": 0
			},
			"11": {
				"name": "magnesium",
				"amount": 0
			},
			"12": {
				"name": "manganese",
				"amount": 0
			},
			"13": {
				"name": "potassium",
				"amount": 0
			},
			"14": {
				"name": "phosphorus",
				"amount": 0
			},
			"15": {
				"name": "selenium",
				"amount": 0
			},
			"16": {
				"name": "sodium",
				"amount": 0
			},
			"17": {
				"name": "theobromine",
				"amount": 0
			},
			"18": {
				"name": "zinc",
				"amount": 0
			}
		}
	},
	"8": {
		"name": "amino acids",
		"amount": {
			"0": {
				"name": "alanine",
				"amount": 0
			},
			"1": {
				"name": "arginine",
				"amount": 0
			},
			"2": {
				"name": "aspartic acid",
				"amount": 0
			},
			"3": {
				"name": "cystine",
				"amount": 0
			},
			"4": {
				"name": "glutamic acid",
				"amount": 0
			},
			"5": {
				"name": "glycine",
				"amount": 0
			},
			"6": {
				"name": "histidine",
				"amount": 0
			},
			"7": {
				"name": "isoleucine",
				"amount": 0
			},
			"8": {
				"name": "leucine",
				"amount": 0
			},
			"9": {
				"name": "lysine",
				"amount": 0
			},
			"10": {
				"name": "methionine",
				"amount": 0
			},
			"11": {
				"name": "phenylalanine",
				"amount": 0
			},
			"12": {
				"name": "proline",
				"amount": 0
			},
			"13": {
				"name": "serine",
				"amount": 0
			},
			"14": {
				"name": "threonine",
				"amount": 0
			},
			"15": {
				"name": "tryptophan",
				"amount": 0
			},
			"16": {
				"name": "tyrosine",
				"amount": 0
			},
			"17": {
				"name": "valine",
				"amount": 0
			}
		}
	},
	"9": {
		"1": {
			"name": "cholesterol",
			"amount": 0
		},
		"2": {
			"name": "phytosterols",
			"amount": 0
		},
		"name": "sterols",
		"amount": 0
	}
}

function walkObject(obj: object, originalData: object, nutritionData: object, outputFields: Array<any>, outputValues: Array<any>) {
	for (let key in obj) {
		if (obj.hasOwnProperty(key)) {

			// @ts-ignore
			if (obj && typeof obj[key] === "string") {

				// @ts-ignore
				let node = searchValue(originalData, key, obj[key], '', 0, nutritionData);

				let loc = node["location"];
				loc = (loc.length > 0)?loc:node["path"];

				loc = loc.substring(1, loc.length-1).split('b').join('');

				loc = loc.split('-').join('"],["');
				outputFields.push(`["${foodItemFrontmatterField}"]["${loc}"]["name"]`);
				// @ts-ignore
				outputValues.push(obj[key]);
				outputFields.push(`["${foodItemFrontmatterField}"]["${loc}"]["amount"]`);
				let fieldVal = '0';
				if(node["val"]) {
					fieldVal = node["val"];
				}
				outputValues.push(fieldVal);


			}
			// @ts-ignore
			if (obj && typeof obj[key] === "object") {
				// @ts-ignore
				walkObject(obj[key], originalData, nutritionData, outputFields, outputValues);
			}
		}
	}
	return { "fields": outputFields, "values": outputValues}
}


// @ts-ignore
function searchValue(obj, key, value, path='', node = 0, nutritionData) {

	if (!obj || (typeof obj != 'object')) {
		path = `${path}-${key}a`;
		return {"state" :false, "obj": {}, val: 0, "path": path, "location": "a"};
	}
	if (obj[key] === value) {
		if(!isNaN(key)) {
			path = `${path}-${key}d`;
		}
		return {"state" :true, "obj": obj[key], val: obj["value"],"key": key, "path": path, "location": "d"};
	}
	for (const k in obj) {
		if (obj.hasOwnProperty(k)) {
			// @ts-ignore
			if(!isNaN(k)) {
				if (Number(k) > Number(node)) {
					node = Number(k);
				} else {
					path = `${path}-${node}b`;
					node = 0;
				}
			}
			let res = searchValue(obj[k], key, value, path, node, nutritionData);

			// @ts-ignore
			if (res["state"] === true) {
				node = (node==0)?1:node;
				path = `${path}-${node}b`;
				let loc = res["path"];;
				if(res["location"] && res["location"].substr(res["location"].length-1, 1) != 'd') {
					loc = res["path"];
					if (res["obj"]["location"]  && res["obj"]["location"].substr(res["obj"]["location"].length-1, 1) != 'd') {
						loc = res["obj"]["path"];
						if (res["obj"]["obj"]["location"]  && res["obj"]["obj"]["location"].substr(res["obj"]["obj"]["location"].length-1, 1) != 'd') {
							loc = res["obj"]["obj"]["path"];
						}
					}
				}
				return {"state" :true, "obj": res, val: nutritionData[value], "key": k, "path": path,  "location": loc};
			}
		}
	}
	path = `${path}-${key}c`;
	return {"state" :false, "obj": obj[key], val: obj["value"], "key": key,"path": path,  "location": "c"};
}
/*
console.log(searchValue(fmc, "name", "glucose")["location"]);
console.log(searchValue(fmc, "name", "fructose")["location"]);
console.log(searchValue(fmc, "name", "dodecanoic_acid")["location"]);
console.log(searchValue(fmc, "name", "hexanoic_acid")["location"]);
*/

let nutritionData = {};
const foodItemFrontmatterField : string = 'nutritional_information_per_100g';
let fields = [];
let values = [];

for (let foodNutritionDataKey in foodNutritionData['fullNutritionalData']) {

	if(foodNutritionData['fullNutritionalData'][foodNutritionDataKey]) {
		// @ts-ignore
		const rawData = foodNutritionData['fullNutritionalData'][foodNutritionDataKey]['raw_nutritional_data'];
		for (let rawDataKey in rawData) {
			// @ts-ignore
			nutritionData[rawData[rawDataKey]["name"]] = rawData[rawDataKey]["value"];

		}
	}
}

console.log(nutritionData);


let fieldsAndValues = walkObject(fmc, fmc, nutritionData, [], []);
console.log(fieldsAndValues);
//walkObject(foodNutritionData["fullNutritionalData"])



/*
let keysIdx = 0;
fields.push(`["${foodItemFrontmatterField}"]["1"]["name"]`);
values.push('energy');
fields.push(`["${foodItemFrontmatterField}"]["1"]["amount"]`);
values.push(555);
*/

