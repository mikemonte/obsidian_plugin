let nutritionData = [
	{
		"title": "Calorie Information",
		"raw_nutritional_data": [
			{
				"name": "energy",
				"value": "208",
				"daily_value": "",
				"units": "kcal"
			}
		]
	},
	{
		"title": "Carbohydrates",
		"raw_nutritional_data": {
			"0": {
				"name": "carbohydrates",
				"value": "0",
				"units": "g"
			},
			"1": {
				"name": "fiber",
				"value": "1.0",
				"units": "g"
			},
			"2": {
				"name": "sugars",
				"value": "0.5",
				"units": "g"
			},
			"3": {
				"name": "net_carbs",
				"value": "0",
				"units": "g"
			},
			"4": {
				"name": "glucose",
				"value": "0.33",
				"units": "g"
			},
			"5": {
				"name": "fructose",
				"value": "0.13",
				"units": "g"
			},
		}
	},
	{
		"title": "Fats & Fatty Acids",
		"raw_nutritional_data": {
			"0": {
				"name": "fat",
				"value": "11.45",
				"units": "g"
			},
			"1": {
				"name": "saturates",
				"value": "1.528",
				"units": "g"
			},
			"2": {
				"name": "butanoic_acid",
				"value": "0",
				"units": "g"
			},
			"3": {
				"name": "decanoic_acid",
				"value": "0",
				"units": "g"
			},
			"4": {
				"name": "dodecanoic_acid",
				"value": "0",
				"units": "g"
			},
			"5": {
				"name": "hexadecanoic_acid",
				"value": "0.993",
				"units": "g"
			},
			"6": {
				"name": "hexanoic_acid",
				"value": "0",
				"units": "g"
			},
			"7": {
				"name": "octadecanoic_acid",
				"value": "0.343",
				"units": "g"
			},
			"8": {
				"name": "octanoic_acid",
				"value": "0",
				"units": "g"
			},
			"9": {
				"name": "tetradecanoic_acid",
				"value": "0.192",
				"units": "g"
			},
			"10": {
				"name": "monounsaturated",
				"value": "3.869",
				"units": "g"
			},
			"11": {
				"name": "docosenoic_acid",
				"value": "1.081",
				"units": "g"
			},
			"12": {
				"name": "eicosenoic_acid",
				"value": "0.423",
				"units": "g"
			},
			"13": {
				"name": "hexadecenoic_acid",
				"value": "0.22",
				"units": "g"
			},
			"14": {
				"name": "octadecenoic_acid",
				"value": "2.145",
				"units": "g"
			},
			"15": {
				"name": "polyunsaturated",
				"value": "5.148",
				"units": "g"
			},
			"16": {
				"name": "DHA",
				"value": "0.5",
				"units": "g"
			},
			"17": {
				"name": "DPA",
				"value": "0",
				"units": "g"
			},
			"18": {
				"name": "EPA",
				"value": "0.473",
				"units": "g"
			},
			"19": {
				"name": "eicosatetraenoic_acid",
				"value": "0",
				"units": "g"
			},
			"20": {
				"name": "octadecadienoic_acid",
				"value": "3.543",
				"units": "g"
			},
			"21": {
				"name": "octadecatetraenoic_acid",
				"value": "0.125",
				"units": "g"
			},
			"22": {
				"name": "octadecatrienoic_acid",
				"value": "0.498",
				"units": "g"
			}
		}
	},
	{
		"title": "Protein & Amino Acids",
		"raw_nutritional_data": {
			"0": {
				"name": "protein",
				"value": "24.62",
				"units": "g"
			},
			"1": {
				"name": "arginine",
				"value": "0.002462",
				"units": "g"
			}
		}
	},
	{
		"title": "Vitamins",
		"raw_nutritional_data": {
			"0": {
				"name": "vitamin_a",
				"value": "0",
				"units": "g"
			},
			"1": {
				"name": "carotene_alpha",
				"value": "0",
				"units": "g"
			},
			"2": {
				"name": "carotene_beta",
				"value": "0",
				"units": "g"
			},
			"3": {
				"name": "cryptoxanthin_beta",
				"value": "0",
				"units": "g"
			},
			"4": {
				"name": "lutein",
				"value": "0",
				"units": "g"
			},
			"5": {
				"name": "lycopene",
				"value": "0",
				"units": "g"
			},
			"6": {
				"name": "retinol",
				"value": "0",
				"units": "g"
			},
			"7": {
				"name": "vitamin_b1",
				"value": "0",
				"units": "g"
			},
			"8": {
				"name": "vitamin_b2",
				"value": "0.000227",
				"units": "g"
			},
			"9": {
				"name": "vitamin_b3",
				"value": "0.005245",
				"units": "g"
			},
			"10": {
				"name": "vitamin_b12",
				"value": "0",
				"units": "g"
			},
			"11": {
				"name": "folate",
				"value": "0",
				"units": "g"
			},
			"12": {
				"name": "vitamin_e",
				"value": "0.002",
				"units": "g"
			},
			"13": {
				"name": "choline",
				"value": "0.075",
				"units": "g"
			}
		}
	},
	{
		"title": "Minerals",
		"raw_nutritional_data": {
			"0": {
				"name": "calcium",
				"value": "0.382",
				"units": "g"
			},
			"1": {
				"name": "copper",
				"value": "0",
				"units": "g"
			},
			"2": {
				"name": "iron",
				"value": "0",
				"units": "g"
			},
			"3": {
				"name": "magnesium",
				"value": "0.039",
				"units": "g"
			},
			"4": {
				"name": "phosphorus",
				"value": "0.49",
				"units": "g"
			},
			"5": {
				"name": "potassium",
				"value": "0.397",
				"units": "g"
			},
			"6": {
				"name": "selenium",
				"value": "0",
				"units": "g"
			},
			"7": {
				"name": "sodium",
				"value": "0.3",
				"units": "g"
			},
			"8": {
				"name": "zinc",
				"value": "0.00131",
				"units": "g"
			}
		}
	}
];


nutritionData = [
	{
		"title": "Calorie Information",
		"raw_nutritional_data": [
			{
				"name": "energy",
				"value": "130",
				"daily_value": "",
				"units": "kcal"
			}
		]
	},
	{
		"title": "Carbohydrates",
		"raw_nutritional_data": {
			"0": {
				"name": "carbohydrates",
				"value": "22.6",
				"units": "g"
			},
			"1": {
				"name": "fiber",
				"value": "0",
				"units": "g"
			},
			"2": {
				"name": "sugars",
				"value": "16.97",
				"units": "g"
			},
			"3": {
				"name": "net_carbs",
				"value": "22.6",
				"units": "g"
			}
		}
	},
	{
		"title": "Fats & Fatty Acids",
		"raw_nutritional_data": {
			"0": {
				"name": "fat",
				"value": "3.78",
				"units": "g"
			},
			"1": {
				"name": "saturates",
				"value": "1.016",
				"units": "g"
			},
			"2": {
				"name": "butanoic_acid",
				"value": "0",
				"units": "g"
			},
			"3": {
				"name": "decanoic_acid",
				"value": "0",
				"units": "g"
			},
			"4": {
				"name": "dodecanoic_acid",
				"value": "0",
				"units": "g"
			},
			"5": {
				"name": "hexadecanoic_acid",
				"value": "0.5",
				"units": "g"
			},
			"6": {
				"name": "hexanoic_acid",
				"value": "0",
				"units": "g"
			},
			"7": {
				"name": "octadecanoic_acid",
				"value": "0.473",
				"units": "g"
			},
			"8": {
				"name": "octanoic_acid",
				"value": "0",
				"units": "g"
			},
			"9": {
				"name": "tetradecanoic_acid",
				"value": "0.01",
				"units": "g"
			},
			"10": {
				"name": "monounsaturated",
				"value": "2.286",
				"units": "g"
			},
			"11": {
				"name": "docosenoic_acid",
				"value": "0",
				"units": "g"
			},
			"12": {
				"name": "eicosenoic_acid",
				"value": "0",
				"units": "g"
			},
			"13": {
				"name": "hexadecenoic_acid",
				"value": "0",
				"units": "g"
			},
			"14": {
				"name": "octadecenoic_acid",
				"value": "2.275",
				"units": "g"
			},
			"15": {
				"name": "polyunsaturated",
				"value": "0.087",
				"units": "g"
			},
			"16": {
				"name": "DHA",
				"value": "0",
				"units": "g"
			},
			"17": {
				"name": "DPA",
				"value": "0",
				"units": "g"
			},
			"18": {
				"name": "EPA",
				"value": "0",
				"units": "g"
			},
			"19": {
				"name": "eicosatetraenoic_acid",
				"value": "0",
				"units": "g"
			},
			"20": {
				"name": "octadecadienoic_acid",
				"value": "0.087",
				"units": "g"
			},
			"21": {
				"name": "octadecatetraenoic_acid",
				"value": "0",
				"units": "g"
			},
			"22": {
				"name": "octadecatrienoic_acid",
				"value": "0",
				"units": "g"
			}
		}
	},
	{
		"title": "Protein & Amino Acids",
		"raw_nutritional_data": {
			"0": {
				"name": "protein",
				"value": "1.45",
				"units": "g"
			}
		}
	},
	{
		"title": "Vitamins",
		"raw_nutritional_data": {
			"0": {
				"name": "vitamin_a",
				"value": "0",
				"units": "g"
			},
			"1": {
				"name": "carotene_alpha",
				"value": "0",
				"units": "g"
			},
			"2": {
				"name": "carotene_beta",
				"value": "0",
				"units": "g"
			},
			"3": {
				"name": "cryptoxanthin_beta",
				"value": "0",
				"units": "g"
			},
			"4": {
				"name": "lutein",
				"value": "0",
				"units": "g"
			},
			"5": {
				"name": "lycopene",
				"value": "0",
				"units": "g"
			},
			"6": {
				"name": "retinol",
				"value": "0",
				"units": "g"
			},
			"7": {
				"name": "vitamin_b1",
				"value": "0",
				"units": "g"
			},
			"8": {
				"name": "vitamin_b2",
				"value": "0.00007",
				"units": "g"
			},
			"9": {
				"name": "vitamin_b3",
				"value": "0",
				"units": "g"
			},
			"10": {
				"name": "vitamin_b12",
				"value": "1.5e-7",
				"units": "g"
			},
			"11": {
				"name": "folate",
				"value": "0",
				"units": "g"
			},
			"12": {
				"name": "vitamin_e",
				"value": "0",
				"units": "g"
			},
			"13": {
				"name": "choline",
				"value": "0.0062",
				"units": "g"
			}
		}
	},
	{
		"title": "Minerals",
		"raw_nutritional_data": {
			"0": {
				"name": "calcium",
				"value": "0.049",
				"units": "g"
			},
			"1": {
				"name": "copper",
				"value": "0",
				"units": "g"
			},
			"2": {
				"name": "iron",
				"value": "0",
				"units": "g"
			},
			"3": {
				"name": "magnesium",
				"value": "0",
				"units": "g"
			},
			"4": {
				"name": "phosphorus",
				"value": "0.041",
				"units": "g"
			},
			"5": {
				"name": "potassium",
				"value": "0.065",
				"units": "g"
			},
			"6": {
				"name": "selenium",
				"value": "0",
				"units": "g"
			},
			"7": {
				"name": "sodium",
				"value": "0.172",
				"units": "g"
			},
			"8": {
				"name": "zinc",
				"value": "0",
				"units": "g"
			}
		}
	}
]
let basicNutritionData = {};

function convertToGrams(val, unit) {
	if(typeof val == 'string') {
		val = Number(val);
	}

	if((typeof val == 'string' && isNaN(parseFloat(val))) || val == -1) {
		val = 0;
	}
	switch (unit) {
		case 'mg':
			val = 0.001 * val;
			break;
		case 'mcg':
		case 'Âµg':
			val = 0.000001 * val;
			break;
		case 'g':
		default:
	}

	return val;
}

for(let i = 0; i < nutritionData.length; i++) {
	let key = '';
	let val = -1;
	let unit = 'g';
	let macro = '';
	console.log(nutritionData[i]["title"])
	if(nutritionData[i] && nutritionData[i]["title"] ) {
		switch (nutritionData[i]["title"]) {
			case 'Calorie Information':
				macro = 'calories'

				for (let entry in nutritionData[i]["raw_nutritional_data"]) {

					val = -1;
					key = '';
					if (typeof basicNutritionData["calories"] == 'undefined') {
						basicNutritionData["calories"] = {};
					}
					if (nutritionData[i]["raw_nutritional_data"][entry]["name"] == 'Calories' || nutritionData[i]["raw_nutritional_data"][entry]["name"] == 'energy') {
						key = 'total_calories'
						val = nutritionData[i]["raw_nutritional_data"][entry]["value"]
					}
					if (nutritionData[i]["raw_nutritional_data"][entry]["units"]) {
						unit = nutritionData[i]["raw_nutritional_data"][entry]["units"];
					}
					console.log(`entry=${entry} key=${key}`)
					if (key != '') {
						val = convertToGrams(val, unit);
						basicNutritionData[macro][key] = val;
					}
				}
				break;
			case 'Carbohydrates':
				macro = 'carbohydrates'
				for (let entry in nutritionData[i]["raw_nutritional_data"]) {
					val = -1;
					key = '';
					if (typeof basicNutritionData[macro] == 'undefined') {
						basicNutritionData[macro] = {};
					}

					if (nutritionData[i]["raw_nutritional_data"][entry]["units"]) {
						unit = nutritionData[i]["raw_nutritional_data"][entry]["units"];
					}

					switch(String(nutritionData[i]["raw_nutritional_data"][entry]["name"]).toLowerCase()) {
						case 'any_carbohydrate_which_needs_modification':
							key = 'any_carbohydrate_which_needs_modification';
							val = nutritionData[i]["raw_nutritional_data"][entry]["value"]
							break;
						case 'sugars':
							key = 'sugar';
							val = nutritionData[i]["raw_nutritional_data"][entry]["value"]
							break;
						default:
							key = String(nutritionData[i]["raw_nutritional_data"][entry]["name"]).toLowerCase();
							val = nutritionData[i]["raw_nutritional_data"][entry]["value"]
					}
					if (key != '') {
						val = convertToGrams(val, unit);
						basicNutritionData[macro][key] = val;
					}
				}
				break;
			case 'Fats & Fatty Acids':
				macro = 'fats';
				for (let entry in nutritionData[i]["raw_nutritional_data"]) {
					val = -1;
					key = '';

					if (typeof basicNutritionData[macro] == 'undefined') {
						basicNutritionData[macro] = {};
					}


					if (nutritionData[i]["raw_nutritional_data"][entry]["units"]) {
						unit = nutritionData[i]["raw_nutritional_data"][entry]["units"];
					}

					switch(String(nutritionData[i]["raw_nutritional_data"][entry]["name"]).toLowerCase()) {
						case 'any_fats_which_needs_modification':
							key = 'any_fats_which_needs_modification';
							val = nutritionData[i]["raw_nutritional_data"][entry]["value"]
							break;
						case 'total trans fatty acids':
							key = "transfats";
							val = nutritionData[i]["raw_nutritional_data"][entry]["value"];
							break;
						case 'epa':
						case 'dha':
						case 'dpa':
							key = "omega-3";

							val = nutritionData[i]["raw_nutritional_data"][entry]["value"];
							if(basicNutritionData['fats'][key]) {
								val = Number(val) + Number(basicNutritionData['fats'][key]);
							}
							break;
						default:
							key = String(nutritionData[i]["raw_nutritional_data"][entry]["name"]).toLowerCase();
							val = nutritionData[i]["raw_nutritional_data"][entry]["value"]
					}
					if (key != '') {
						val = convertToGrams(val, unit);
						basicNutritionData[macro][key] = val;
					}
				}
				break;

			case 'Protein & Amino Acids':
				macro = 'protein';
				for (let entry in nutritionData[i]["raw_nutritional_data"]) {
					val = -1;
					key = '';
					if (typeof basicNutritionData[macro] == 'undefined') {
						basicNutritionData[macro] = {};
					}

					if (nutritionData[i]["raw_nutritional_data"][entry]["units"]) {
						unit = nutritionData[i]["raw_nutritional_data"][entry]["units"];
					}

					switch(String(nutritionData[i]["raw_nutritional_data"][entry]["name"]).toLowerCase()) {
						case 'any_protein_which_needs_modification':
							key = 'any_protein_which_needs_modification';
							val = nutritionData[i]["raw_nutritional_data"][entry]["value"]
							break;
						default:
							key = String(nutritionData[i]["raw_nutritional_data"][entry]["name"]).toLowerCase();
							val = nutritionData[i]["raw_nutritional_data"][entry]["value"]
					}
					if (key != '') {
						val = convertToGrams(val, unit);
						basicNutritionData[macro][key] = val;
					}
				}
				break;
			case 'Vitamins':
				macro = 'vitamins';
				for (let entry in nutritionData[i]["raw_nutritional_data"]) {
					val = -1;
					key = '';
					if (typeof basicNutritionData[macro] == 'undefined') {
						basicNutritionData[macro] = {};
					}

					if (nutritionData[i]["raw_nutritional_data"][entry]["units"]) {
						unit = nutritionData[i]["raw_nutritional_data"][entry]["units"];
					}

					switch(String(nutritionData[i]["raw_nutritional_data"][entry]["name"]).toLowerCase()) {
						case 'any_vitamin_which_needs_modification':
							key = 'any_vitamin_which_needs_modification';
							val = nutritionData[i]["raw_nutritional_data"][entry]["value"]
							break;
						default:
							key = String(nutritionData[i]["raw_nutritional_data"][entry]["name"]).toLowerCase();
							val = nutritionData[i]["raw_nutritional_data"][entry]["value"]
					}
					if (key != '') {
						val = convertToGrams(val, unit);
						basicNutritionData[macro][key] = val;
					}
				}
				break;
			case 'Minerals':
				macro = 'minerals';
				for (let entry in nutritionData[i]["raw_nutritional_data"]) {
					val = -1;
					key = '';
					if (typeof basicNutritionData['minerals'] == 'undefined') {
						basicNutritionData[macro] = {};
					}

					if (nutritionData[i]["raw_nutritional_data"][entry]["units"]) {
						unit = nutritionData[i]["raw_nutritional_data"][entry]["units"];
					}

					switch(String(nutritionData[i]["raw_nutritional_data"][entry]["name"]).toLowerCase()) {
						case 'any_mineral_wchich_needs_modification':
							key = 'any_mineral_wchich_needs_modification';
							val = nutritionData[i]["raw_nutritional_data"][entry]["value"]
							break;
						default:
							key = String(nutritionData[i]["raw_nutritional_data"][entry]["name"]).toLowerCase();
							val = nutritionData[i]["raw_nutritional_data"][entry]["value"]
					}

					if (key != '') {
						val = convertToGrams(val, unit);
						basicNutritionData[macro][key] = val;
					}
				}
				break;
			default:
		}
	}
}

console.log(basicNutritionData);
